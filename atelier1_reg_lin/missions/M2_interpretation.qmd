---
title: "Mission 2 — Tester & interpréter"
format: html
---

```{r}
source("../../utils/requirements.R")
library(AmesHousing); set.seed(42); library(dplyr); library(broom)
ames <- make_ames()
idx <- sample(seq_len(nrow(ames)), size = floor(.8*nrow(ames)))
train <- ames[idx,]; test <- ames[-idx,]
mod <- lm(Sale_Price ~ Gr_Liv_Area + Overall_Qual + Year_Built + Full_Bath + Garage_Cars, data=train)
```

## Tâches
1. **Prédire** `Sale_Price` sur `test` et calculer **RMSE/MAE**.
```{r}
pred <- predict(mod, newdata=test)
rmse <- sqrt(mean((pred - test$Sale_Price)^2))
mae <- mean(abs(pred - test$Sale_Price))
knitr::kable(data.frame(RMSE = rmse, MAE = mae), caption = "Performance prédictive sur test")
```

2. **Comparer** avec un modèle plus simple (3 variables).
```{r}
mod_small <- lm(Sale_Price ~ Gr_Liv_Area + Overall_Qual + Year_Built, data=train)
pred_s <- predict(mod_small, newdata=test)
rmse_s <- sqrt(mean((pred_s - test$Sale_Price)^2))
mae_s <- mean(abs(pred_s - test$Sale_Price))
knitr::kable(data.frame(Model=c("Complet","Simple"),
 RMSE=c(rmse, rmse_s),
 MAE=c(mae, mae_s)))
```

3. **Discuter**: biais-variance, sur-ajustement potentiel.

## Questions
- Q1. Le $ R^2 $ plus élevé du grand modèle se traduit-il par un **RMSE** plus faible ?
- Q2. Quelle variable retireriez-vous pour livrer un modèle *robuste* et *interprétable* ?

## Points de discussion
- Différence entre qualité d’ajustement et **performance prédictive**
- Importance du **domaine** dans la sélection des variables
---

## Points de discussion — approfondis
- **Justification métier** des variables incluses ou exclues (au-delà des p-valeurs).
- **Stabilité** des coefficients : colinéarité, sous-échantillonnage répété (idée de validation).
- **Éthique & communication** : comment présenter l’incertitude à un public non technique.
- **Reproductibilité** : graine aléatoire, sessionInfo(), versionnage du code.

## Questions bonus
1. Proposez une transformation (log, standardisation, polynomial) pour un prédicteur et justifiez-la.
2. Identifiez un point potentiellement influent et discutez s’il faut l’exclure (et pourquoi).
